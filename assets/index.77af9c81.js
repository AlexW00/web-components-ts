var C=Object.defineProperty;var M=(i,t,e)=>t in i?C(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var r=(i,t,e)=>(M(i,typeof t!="symbol"?t+"":t,e),e);const x=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}};x();class V extends HTMLElement{constructor(e,o){super();r(this,"html");r(this,"css");this.html=e!=null?e:"",this.css=o!=null?o:"",this.attachShadow({mode:"open"})}notifyAll(e,o){const n=new CustomEvent(e,{detail:o});this.dispatchEvent(n)}get root(){if(this.shadowRoot)return this.shadowRoot;throw new Error("WebComponent.root is not available yet")}select(e){return this.root.querySelector(e)}selectAll(e){return this.root.querySelectorAll(e)}async connectedCallback(){this.loadStylesheet(),this.loadHtml(),this.onConnected()}loadStylesheet(){if(this.css!==""){const e=document.createElement("style");e.innerHTML=this.css,this.root.appendChild(e)}}loadHtml(){if(this.html!==""){const e=document.createElement("template");e.innerHTML=this.html,this.root.appendChild(e.content.cloneNode(!0))}}}const A=`p{display:inline-block;color:#ff871e}.red{color:red}.containter{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}
`,b=`<div class="red containter">
	<h1></h1>
	<div>Count: <span id="count">0</span></div>
	<button>Click here!</button>
</div>
`;class g extends V{constructor(e){super(b,A);r(this,"exampleViewModel");r(this,"onButtonClicked",()=>{this.exampleViewModel.value.count++});r(this,"onViewModelChanged",e=>{this.select("#count").innerHTML=`${this.exampleViewModel.value.count}`,console.log("COMPONENT ViewModel changed:",e)});this.exampleViewModel=e}get htmlTagName(){return"example-component"}onConnected(){this.root.querySelector("h1").innerHTML=`Hello ${this.exampleViewModel.value.name}!`,this.select("#count").innerHTML=`${this.exampleViewModel.value.count}`,this.select("button").addEventListener("click",this.onButtonClicked),this.exampleViewModel.addEventListener("change",this.onViewModelChanged)}}const L=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"})),T="modulepreload",D=function(i){return"/web-components-ts/"+i},E={},N=function(t,e,o){return!e||e.length===0?t():Promise.all(e.map(n=>{if(n=D(n),n in E)return;E[n]=!0;const s=n.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${l}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":T,s||(c.as="script",c.crossOrigin=""),c.href=n,document.head.appendChild(c),s)return new Promise((v,w)=>{c.addEventListener("load",v),c.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())},m=class{static async initComponentDefinitions(){const t=Object.assign({"../../components/ExampleComponent/ExampleComponent.ts":()=>N(()=>Promise.resolve().then(()=>L),void 0)}),e=Object.keys(t);for(const o of e){const s=(await t[o]()).default;if(s&&s.prototype.htmlTagName){const l=new P(s.prototype.htmlTagName,s);m.addComponentDefinition(l)}}m.defineAll()}static addComponentDefinition(t){this.componentDefinitions.push(t)}static defineAll(){this.componentDefinitions.forEach(t=>t.defineSelf())}};let h=m;r(h,"componentDefinitions",[]);class P{constructor(t,e){this.name=t,this.componentConstructor=e}defineSelf(){customElements.define(this.name,this.componentConstructor)}}class H{constructor(t,e){r(this,"type");r(this,"data");this.type=t,this.data=e,Object.freeze(this)}}class O{constructor(){r(this,"listener",{})}addEventListener(t,e){this.listener[t]===void 0&&(this.listener[t]=[]),this.listener[t].push(e)}removeEventListener(t,e){if(this.listener[t]!==void 0){for(let o=0;o<this.listener[t].length;o++)if(this.listener[t][o]===e){this.listener[t].splice(o,1);return}}}notifyAll(t,e){const o=new H(t,e);if(this.listener[o.type]!==void 0)for(let n=0;n<this.listener[o.type].length;n++)this.listener[o.type][n](o)}clear(){this.listener={}}}const f=class extends O{constructor(e){super();r(this,"_value");r(this,"_proxyHandler",{set:(e,o,n)=>(e[o]!==n&&(e[o]=n,this.notifyAll(f.LIVE_DATA_CHANGED_EVENT,n)),!0),get:(e,o)=>{if(o=="isProxy")return!0;const n=e[o];if(!(typeof n>"u"))return!n.isProxy&&typeof n=="object"?this._createProxy(n):n}});this._setValue(e)}_setValue(e){this._value=typeof e=="object"?this._createProxy(e):e}_createProxy(e){return new Proxy(e,this._proxyHandler)}get value(){return this._value}set value(e){this._setValue(e),this.notifyAll(f.LIVE_DATA_CHANGED_EVENT,this)}};let d=f;r(d,"LIVE_DATA_CHANGED_EVENT","change");class S extends d{constructor(t){super(t)}}const p=class{constructor(){r(this,"_id","");r(this,"_viewModel");this._generateId()}getViewModel(){return this._viewModel||(this._viewModel=new S(this)),this._viewModel}_generateId(){const t=this.constructor.name;let e=p._modelCounts.get(t);e===void 0&&(e=0),p._modelCounts.set(t,e+1),this._id=t+"-"+e,Object.freeze(this._id)}get id(){return this._id}};let u=p;r(u,"_modelCounts",new Map);class _ extends u{constructor(e,o){super();r(this,"name");r(this,"count");this.name=e,this.count=o}}const y=class{static async initModels(){y.addModel(new _("John",0)),y.addModel(new _("Ben",5))}static addModel(t){this._models.set(t.id,t)}static getModelById(t){return this._models.get(t)}static findModel(t,e){for(const o of this._models.values())if(o instanceof e&&t(o))return o}static findModels(t,e){const o=[];for(const n of this._models.values())n instanceof e&&t(n)&&o.push(n);return o}};let a=y;r(a,"_models",new Map);h.initComponentDefinitions().then(()=>a.initModels()).then(()=>I());function I(){const i=a.findModel(e=>e.name==="John",_).getViewModel(),t=new g(i);document.querySelector("#app").append(t),i.addEventListener(d.LIVE_DATA_CHANGED_EVENT,e=>{console.log("MAIN ViewModel changed:",e),console.log(a)})}
