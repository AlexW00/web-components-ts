var v=Object.defineProperty;var w=(i,t,e)=>t in i?v(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var r=(i,t,e)=>(w(i,typeof t!="symbol"?t+"":t,e),e);const C=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}};C();class y extends HTMLElement{constructor(e,o){super();r(this,"html");r(this,"css");this.html=e!=null?e:"",this.css=o!=null?o:"",this.attachShadow({mode:"open"})}get root(){if(this.shadowRoot)return this.shadowRoot;throw new Error("WebComponent.root is not available yet")}select(e){return this.root.querySelector(e)}selectAll(e){return this.root.querySelectorAll(e)}async connectedCallback(){this.loadStylesheet(),this.loadHtml(),this.onConnected()}async loadStylesheet(){if(this.css!==""){const e=document.createElement("style");e.innerHTML=this.css,this.root.appendChild(e)}}async loadHtml(){if(this.html!==""){const e=document.createElement("template");e.innerHTML=this.html,this.root.appendChild(e.content.cloneNode(!0))}}}const M=Object.freeze(Object.defineProperty({__proto__:null,default:y},Symbol.toStringTag,{value:"Module"})),x=`p{display:inline-block;color:#ff871e}.red{color:red}.containter{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}
`,V=`<div class="red containter">
	<h1></h1>
	<div>Count: <span id="count">0</span></div>
	<button>Click me!</button>
</div>
`;class E extends y{constructor(e){super(V,x);r(this,"exampleViewModel");r(this,"onButtonClicked",()=>{this.exampleViewModel.value.count++});r(this,"onViewModelChanged",e=>{this.select("#count").innerHTML=`${this.exampleViewModel.value.count}`,console.log("COMPONENT ViewModel changed:",e)});this.exampleViewModel=e}get htmlTagName(){return"example-component"}onConnected(){this.root.querySelector("h1").innerHTML=`Hello ${this.exampleViewModel.value.name}!`,this.select("#count").innerHTML=`${this.exampleViewModel.value.count}`,this.select("button").addEventListener("click",this.onButtonClicked),this.exampleViewModel.addEventListener("change",this.onViewModelChanged)}}const A=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),b="modulepreload",T=function(i){return"/web-components-ts/"+i},m={},f=function(t,e,o){return!e||e.length===0?t():Promise.all(e.map(n=>{if(n=T(n),n in m)return;m[n]=!0;const s=n.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${l}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":b,s||(c.as="script",c.crossOrigin=""),c.href=n,document.head.appendChild(c),s)return new Promise((_,g)=>{c.addEventListener("load",_),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())},u=class{static async loadAll(){const t=Object.assign({"./ExampleComponent/ExampleComponent.ts":()=>f(()=>Promise.resolve().then(()=>A),void 0),"./WebComponent.ts":()=>f(()=>Promise.resolve().then(()=>M),void 0)}),e=Object.keys(t);for(const o of e){const s=(await t[o]()).default;if(s&&s.prototype.htmlTagName){const l=new L(s.prototype.htmlTagName,s);u.addComponentDefinition(l)}}u.defineAll()}static addComponentDefinition(t){this.componentDefinitions.push(t)}static defineAll(){this.componentDefinitions.forEach(t=>t.defineSelf())}};let d=u;r(d,"componentDefinitions",[]);class L{constructor(t,e){this.name=t,this.componentConstructor=e}defineSelf(){customElements.define(this.name,this.componentConstructor)}}class P{constructor(t,e){r(this,"type");r(this,"data");this.type=t,this.data=e,Object.freeze(this)}}class N{constructor(){r(this,"listener",{})}addEventListener(t,e){this.listener[t]===void 0&&(this.listener[t]=[]),this.listener[t].push(e)}removeEventListener(t,e){if(this.listener[t]!==void 0){for(let o=0;o<this.listener[t].length;o++)if(this.listener[t][o]===e){this.listener[t].splice(o,1);return}}}notifyAll(t,e){const o=new P(t,e);if(this.listener[o.type]!==void 0)for(let n=0;n<this.listener[o.type].length;n++)this.listener[o.type][n](o)}clear(){this.listener={}}}const h=class extends N{constructor(e){super();r(this,"_value");r(this,"_proxyHandler",{set:(e,o,n)=>(e[o]!==n&&(e[o]=n,this.notifyAll(h.LIVE_DATA_CHANGED_EVENT,n)),!0),get:(e,o)=>{if(o=="isProxy")return!0;const n=e[o];if(!(typeof n>"u"))return!n.isProxy&&typeof n=="object"&&n!=null?this._createProxy(n):n}});this._setValue(e)}_setValue(e){this._value=typeof e=="object"?this._createProxy(e):e}_createProxy(e){return new Proxy(e,this._proxyHandler)}get value(){return this._value}set value(e){this._setValue(e),this.notifyAll(h.LIVE_DATA_CHANGED_EVENT,this)}};let a=h;r(a,"LIVE_DATA_CHANGED_EVENT","change");class S extends a{constructor(t){super(t)}}class D{constructor(){r(this,"_viewModel")}getViewModel(){return this._viewModel||(this._viewModel=new S(this)),this._viewModel}}class O extends D{constructor(e,o){super();r(this,"name");r(this,"count");this.name=e,this.count=o}}const p=new O("John",0);d.loadAll().then(()=>{const i=new E(p.getViewModel());document.querySelector("#app").append(i),p.getViewModel().addEventListener(a.LIVE_DATA_CHANGED_EVENT,t=>{console.log("MAIN ViewModel changed:",t)})});
